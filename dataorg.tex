\documentclass[aspectratio=169,12pt,t]{beamer}
\usepackage{graphicx}
\setbeameroption{hide notes}
\setbeamertemplate{note page}[plain]
\usepackage{listings}
\usepackage{eepic}

\input{header.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% end of header
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% title info
\title{data organization in spreadsheets}
\subtitle{}
\author{\href{https://kbroman.org}{Karl Broman}}
\institute{Biostatistics \& Medical Informatics, UW{\textendash}Madison}
\date{\href{https://kbroman.org}{\tt \scriptsize \color{foreground} kbroman.org}
\\[-4pt]
\href{https://github.com/kbroman}{\tt \scriptsize \color{foreground} github.com/kbroman}
\\[-4pt]
\href{https://twitter.com/kwbroman}{\tt \scriptsize \color{foreground} @kwbroman}
\\[-4pt]
{\scriptsize Slides: \href{https://kbroman.org/Talk_DataOrg}{\tt kbroman.org/Talk\_DataOrg}}
}


\begin{document}

% title slide
{
\setbeamertemplate{footline}{} % no page number here
\frame{
  \titlepage

  \vfill \hfill \includegraphics[height=6mm]{Figs/cc-zero.png} \vspace*{-5mm}

\note{
  These are slides for a talk for the OSGA Webinar Series
  on 24 Sept 2021, based on
  my paper of the same title with Kara Woo,
  {\tt doi.org/gdz6cm}.
}

} }



\begin{frame}[c]{}


  \figh{Figs/spreadsheet_ugly.pdf}{0.8}


  \note{
    Spreadsheets are super useful for storing and organizing datasets.
    But how should you arrange the data in a spreadsheet?

    Often, data are arranged as they might appear in a table in a
    paper. This may be pleasing to view, but it can be make
    down-stream analysis difficult.

    Data analysts often spend a lot of time rearranging data prior to
    analysis. Here, I'll take about how to organize data in
    spreadsheets, for ease of analysis.
  }

\end{frame}





\begin{frame}[c]{}


  \figh{Figs/dataorg_paper.png}{0.7}

  \vspace{10mm}
  \hfill \href{https://doi.org/gdz6cm}{\tt \lolit doi.org/gdz6cm}
  \vspace{-10mm}

  \note{
    A particular collaborator's data (not that shown on the previous
    slide) led me to write a website on data organization, which then
    led to this paper.
  }

\end{frame}





\begin{frame}[c]{}

  \centering
  \Large

  Be consistent

  \note{
    First, be consistent.
  }

\end{frame}


{
% invert colors on this slide
\setbeamercolor{normal text}{bg=foreground, fg=background}
\color{background}

\begin{frame}<handout:0>[c]{}

  \addtocounter{framenumber}{-1}

  \centering
  \fontsize{66pt}{66}\selectfont

  Be consistent

\end{frame}
}


\begin{frame}{Consistent categories}

  \bigskip

  \figh{Figs/consistent_cats.pdf}{0.7}

  \note{

  }

\end{frame}



\begin{frame}{Consistent missing values}

  \bigskip

  \figh{Figs/consistent_nas.pdf}{0.7}

  \bigskip

  \only<2>{\centerline{\large And no {\tt \vhilit 999} or {\tt \vhilit -999}!}}

  \note{

  }

\end{frame}



\begin{frame}{Consistent subject IDs}

  \bigskip

  \figh{Figs/consistent_ids.pdf}{0.7}

  \note{

  }

\end{frame}




\begin{frame}{Consistent column names}

\fighnc{Figs/spreadsheet_colnames1.pdf}{0.8}

\vspace*{-0.6\textheight}
\hspace*{0.1\textwidth}
\fighnc{Figs/spreadsheet_colnames2.pdf}{0.8}

  \note{

  }

\end{frame}



\begin{frame}{Consistent layout}


\fighnc{Figs/spreadsheet_colnames1.pdf}{0.8}

\vspace*{-0.6\textheight}
\hspace*{0.1\textwidth}
\fighnc{Figs/spreadsheet_colnames2.pdf}{0.8}

\vspace*{-0.6\textheight}
\hspace*{0.2\textwidth}
\fighnc{Figs/spreadsheet_colnames3.pdf}{0.8}

  \note{

  }

\end{frame}




\begin{frame}[c]{Consistent date format}

  \figh{Figs/dates.pdf}{0.8}

  \note{

  }

\end{frame}



\begin{frame}[c]{}

\vspace{24pt}

\figh{Figs/iso_8601.png}{0.8}

\vfill

\hfill {\tt \footnotesize \lolit \href{http://xkcd.com/1179/}{xkcd.com/1179}}



  \note{
    Go with the xkcd format for writing dates, for ease of sorting.
  }

\end{frame}





\begin{frame}[c]{}

\figwboxed{Figs/oct4_tweet_1.png}{0.7}

\figwboxed{Figs/oct4_tweet_2.png}{0.7}

  \note{

  }

\end{frame}






\begin{frame}[fragile]{Consistent file names}

\vspace*{-24pt}

\begin{semiverbatim}
\begin{lstlisting}
Complete F2 Liver TG Set.xls
CPL Rosetta Lipids FINAL.xls
D2O Summary of All F2 Samples MF 30July2009.xls
FINAL RBM Data 102989 26Sept2007.xls
Mapped Urine Plasma Data to Statgen.xls
Necropsy Tracking Report rk 2011-04-26.xls
Necropsy Tracking Report rk61412.xls
Necropsy_Tracking_Report_rk_052912_atb.xls
Original Necropsy Tracking Report rk.xls
RBM Tube Number Key.xls
\end{lstlisting}
\end{semiverbatim}

\vspace*{-24pt}

\only<2>{
  \bi
\item No spaces or special characters
\item Short but descriptive
\item Consistent scheme
\item Take advantage of computer sorting
  \ei
}

  \note{

  }

\end{frame}



\begin{frame}[c]{No ``{\hilit final}'' in file names}

\vspace*{3mm}

\centering

% comic from http://www.phdcomics.com/comics/archive.php?comicid=1531
\figh{Figs/phd101212s.png}{0.8}

\note{
  Never include ``final'' in a file name.
}

\end{frame}




\begin{frame}{Choose good names for things}

  \bigskip

  \figw{Figs/variable_names_table.png}{1.0}


  \bigskip
  \bigskip
  \bigskip
  \hfill
\href{https://www.datacarpentry.org/spreadsheet-ecology-lesson/02-common-mistakes}{\lolit
  \tt DataCarpentry.org}


  \note{

  }

\end{frame}




\begin{frame}[c]{No empty cells}

  \only<1>{\figh{Figs/skipping_cells.pdf}{0.8}}
  \only<2|handout 0>{\figh{Figs/skipping_cells_2.pdf}{0.8}}

  \note{
  }
\end{frame}




\begin{frame}[c]{One thing per cell}

  % TODO
  % units; notes

  \note{
  }
\end{frame}




\begin{frame}[c]{Make it a rectangle}

  \begin{columns}

    \column{0.5\textwidth}

    \figh{Figs/not_rectangle_1.pdf}{0.4}
    \bigskip

    \figw{Figs/not_rectangle_3.pdf}{1.0}

    \column{0.5\textwidth}

    \figh{Figs/not_rectangle_2.pdf}{0.4}
    \bigskip

    \figh{Figs/not_rectangle_4.pdf}{0.4}

  \end{columns}

  \note{
  }
\end{frame}


\begin{frame}{Make it a rectangle}

    \fighnc{Figs/not_rectangle_1.pdf}{0.7}

    \only<2>{
      \vspace*{-0.45\textheight}
      \hspace*{0.30\textwidth}
      \fighnc{Figs/rectangle.pdf}{0.6}
    }

  \note{
  }
\end{frame}




\begin{frame}{Make it a rectangle}

    \fighnc{Figs/not_rectangle_2.pdf}{0.7}

    \only<2>{
      \vspace*{-0.55\textheight}
      \hspace*{0.20\textwidth}
      \fighnc{Figs/not_rectangle_2_corr1.pdf}{0.7}
    }

  \note{
  }
\end{frame}




\begin{frame}{Make it a rectangle}

  \begin{columns}
    \column{0.35\textwidth}

    \figw{Figs/not_rectangle_2_corr2a.pdf}{1.0}

    \column{0.65\textwidth}

    \only<1|no handout>{
      \fighnc{Figs/not_rectangle_2_corr2b.pdf}{0.8}
    }
    \only<2>{
      \fighnc{Figs/not_rectangle_2_corr3b.pdf}{0.8}
    }

  \end{columns}

  \note{
  }
\end{frame}


\begin{frame}{Make it a rectangle}

    \fighnc{Figs/not_rectangle_3.pdf}{0.55}

    \only<2->{
      \vspace*{-0.37\textheight}
      \hspace*{0.10\textwidth}
      \fighnc{Figs/not_rectangle_3_corr1.pdf}{0.55}
    }

    \only<3>{
      \vspace*{-0.37\textheight}
      \hspace*{0.20\textwidth}
      \fighnc{Figs/not_rectangle_3_corr2.pdf}{0.65}
    }

  \note{
  }
\end{frame}




\begin{frame}[c]{Make it a rectangle}

    \figh{Figs/not_rectangle_4.pdf}{0.8}


  \note{
  }
\end{frame}







\begin{frame}[c]{}


  \LARGE
  \centering
  No calculations in the data file

  % TODO add a figure with an extraneous number in the IDs

  \note{
  }
\end{frame}




\begin{frame}[c]{Make a data dictionary}

  \figh{Figs/data_dict.pdf}{0.8}

  \note{
    Create a data dictionary, describing the variables in your
    dataset.

    I'd like to also have versions of the variable names useful in
    plots. It can also be useful to classify the variables or include
    other information about the measurement process, units, and allowed
    values/ranges.

    Metadata is data, so put it in a spreadsheet and make it a
    rectangle.
  }
\end{frame}




\begin{frame}[c]{No color/formatting as data}

\only<1>{
\hspace{0.1\textwidth}
  \fighnc{Figs/no_highlighting.pdf}{0.7} }

\only<2|handout 0>{
\hspace{0.1\textwidth}
\fighnc{Figs/no_highlighting_2.pdf}{0.7} }

  \note{
  }
\end{frame}



\begin{frame}{Make backups}

  \bbi
\item Automatic
\item Multiple locations (including off site)
\item Consider formal version control
  \ei

  \note{
  }
\end{frame}



\begin{frame}[c]{Use data validation}

  % TODO
  % give example?


  \note{
  }
\end{frame}




\begin{frame}{Save as plain text}

  \bbi
\item Don't rely on a proprietary format
\item Save as a comma-delimited (CSV) or tab-delimited (TSV) file
  \bi
\item[] Or vertical-bar-delimited?
  \ei
  \ei

  \note{
  }
\end{frame}




\begin{frame}{Summary}

  \begin{columns}

    \column{0.5\textwidth}

    \bbe
  \item Be consistent
  \item Write dates as {\tt YYYY-MM-DD}
  \item Choose good names for things
  \item No empty cells
  \item One thing per cell
  \item Make it a rectangle
    \ee

    \column{0.5\textwidth}

    \bbe
    \addtocounter{enumi}{6}
  \item Make a data dictionary
  \item No calculations in the data file
  \item No color/formatting as data
  \item Make backups
  \item Use data validation
  \item Save as plain text
    \ee

    \end{columns}


  \note{

  }

\end{frame}




\begin{frame}{Acknowledgements}


  \bbi
\item[] Kara Woo
\item[] Jenny Bryan
\item[] Hadley Wickham
\item[] All of my past scientific collaborators
  \ei

  \note{
    Thanks to Kara Woo, without whom this would never have become a
    proper paper.

    And thanks to Jenny Bryan and Hadley Wickham for encouraging us.

    And of course to my 20 years of collaborators and their creative
    uses of Excel.
  }

\end{frame}


\begin{frame}{Further reading}


{\small

  \bi
\item Broman KW, Woo KH (2018) Data organization in spreadsheets. Am Stat 72:2-10
 \href{https://doi.org/gdz6cm}{\tt doi.org/gdz6cm}
\item White EP et al. (2013) Nine simple ways to make it easier to
  (re)use your data. Ideas Ecol Evol 6:1-10
  \href{https://doi.org/10.4033/iee.2013.6b.6.f}{\tt doi.org/10.4033/iee.2013.6b.6.f}
\item Briney K (2015) Data management for researchers. Pelagic
  Publishing.
  \href{https://pelagicpublishing.com/products/data-management-for-researchers-briney}{ISBN: 9781784270117}
\item Ziemann et al (2016) Gene name errors are widespread in the
  scientific literature. Genome Biol 17:177
  \href{https://doi.org/10.1186/s13059-016-1044-7}{\tt doi.org/10.1186/s13059-016-1044-7}
\item Ellis SE, Leek JT (2018) How to share data for collaboration.
  Am Stat 72:53-57
  \href{https://doi.org/10.1080/00031305.2017.1375987}{\tt doi.org/10.1080/00031305.2017.1375987}
\item Wilson SL et al. (2021) Sharing biological data: why, when, and
  how. FEBS Letters 595:847-863
  \href{https://doi.org/10.1002/1873-3468.14067}{\tt doi.org/10.1002/1873-3468.14067}
  \ei

}

  \note{
  }

\end{frame}


\begin{frame}[c]{}

\Large

Slides: \href{https://kbroman.org/Talk_DataOrg}{\tt kbroman.org/Talk\_DataOrg}
\hfill \includegraphics[height=7mm]{Figs/cc-zero.png}

\vspace{7mm}

\href{https://kbroman.org}{\tt \lolit kbroman.org}

\vspace{7mm}

\href{https://github.com/kbroman}{\tt \lolit github.com/kbroman}

\vspace{7mm}

\href{https://twitter.com/kwbroman}{\tt \lolit @kwbroman}


\note{
  Here's where you can find me and the slides.
}

\end{frame}




\end{document}
